import { Meta } from "@storybook/addon-docs/blocks";
import { styled } from 'storybook/theming';

import "../../src/base.css";
import { Slide } from "../../src/components/Slide";

export const RightSideDecoration = styled.div`
  position: absolute;
  right: 0;
  top: 50%;
  width: 840px;
  z-index: 2000;
  transform: translateY(-50%) translateX(80%);
  box-shadow: 0 0 30px color(from var(--color-bg) srgb r g b / 0.5);
  transition: transform 0.4s ease-out;
  &:hover {
    transform: translateY(-50%) translateX(10%);
  }

  & pre {
    margin: 0;
  }
`;

<Meta title="Slide 5" />

<Slide>
  ## The story index

<div style={{ marginTop: '3rem' }}>
  Storybook is divided in three application contexts:

  * <strong style={{ color: 'var(--color-text-accent)'}}>Main</strong>   The Node.js server app loading your stories and running the React dev server
  * <strong style={{ color: 'var(--color-text-accent)'}}>Manager</strong>   The React client powering the Storybook UI
  * <strong style={{ color: 'var(--color-text-accent)'}}>Preview</strong>   The iframe where your stories are rendered in your own framework
</div>

<div style={{ marginTop: '3rem', width: '74%' }}>
  ```js
  // .storybook/main.ts
  export default {
    stories: ['../src/**/*.stories.@(js|jsx|mjs|ts|tsx)'],
  }
  ```
</div>

<div style={{ marginTop: '3rem' }}>
  The main server reads your `stories` files and produces an index of all the components, stories and docs entries they contain.
  <p style={{fontSize: 'var(--font-size-lg)', color: 'var(--color-text-accent)', fontWeight: 500 }}>This index can be fetched from the manager or preview contexts, at `/index.json`.</p>
</div>

  <RightSideDecoration>
    ```json
    // (await fetch('/index.json')).json()
    {
      "v": 5,
      "entries": {
        "components-button--primary": {
          "type": "story",
          "id": "components-button--primary",
          "name": "Primary",
          "title": "Components/Button",
          "importPath": "./src/components/Button.stories.tsx",
          "componentPath": "./src/components/Button.tsx",
          "tags": ["dev", "test"]
        },
        "components-button--secondary": {
          "type": "story",
          "id": "components-button--secondary",
          "name": "Secondary",
          "title": "Components/Button",
          "importPath": "./src/components/Button.stories.tsx",
          "componentPath": "./src/components/Button.tsx",
          "tags": ["dev", "test"]
        }
      }
    }
    ```
  </RightSideDecoration>
</Slide>
